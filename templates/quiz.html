{% extends "layout.html" %}

{% block content %}
<div class="quiz-container text-center mt-4">
  <h2 id="question">Loading question...</h2>
  <img id="question-image" src="" alt="Quiz Image" style="max-width: 400px;" />
  <div id="choices" class="choices-container mt-3"></div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    let currentQuestionIndex = 0;
    let quizData = [];

    function loadQuestion(index) {
      const questionContainer = document.getElementById("question");
      const imageContainer = document.getElementById("question-image");
      const choicesContainer = document.getElementById("choices");

      const question = quizData[index];
      questionContainer.textContent = question.question;
      imageContainer.src = "{{ url_for('static', filename='images/') }}" + question.image;

      choicesContainer.innerHTML = "";
      question.choices.forEach(choice => {
        const button = document.createElement("button");
        button.textContent = choice;
        button.className = "btn btn-outline-primary mx-2 my-1";
        button.addEventListener("click", () => {
          alert(choice === question.correct ? "Correct!" : "Try again!");
          if (currentQuestionIndex < quizData.length - 1) {
            currentQuestionIndex++;
            loadQuestion(currentQuestionIndex);
          } else {
            alert("Quiz complete!");
          }
        });
        choicesContainer.appendChild(button);
      });
    }

    fetch("{{ url_for('static', filename='quiz_data.json') }}")
      .then(response => response.json())
      .then(data => {
        quizData = data;
        loadQuestion(currentQuestionIndex);
      })
      .catch(error => {
        console.error("Failed to load quiz data:", error);
      });
  });
</script>
{% endblock %}
